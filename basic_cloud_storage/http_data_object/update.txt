.. _http_data_object_update:

    
Update a Data Object using HTTP
*******************************


Synopsis
--------

The following HTTP PUT updates an existing data object at the specified URI:

    ``PUT <root URI>/<ContainerName>/<DataObjectName>``

Where:

* ``<root URI>`` is the path to the CDMI cloud.
* ``<ContainerName>`` is zero or more intermediate containers.
* ``<DataObjectName>`` is the name of the data object to be updated.

The object shall also be accessible at ``<root URI>/cdmi_objectid/<objectID>``. An update shall not result in a change to the object ID.



Capabilities
------------

The following capabilities describe the supported operations that may be performed when updating an existing data object:

* Support for the ability to modify the value of an existing data object and/or MIME type is indicated by the presence of the ``cdmi_modify_value capability`` in the specified object.
* Support for the ability to modify the value of an existing data object in specified byte ranges is indicated by the presence of the ``cdmi_modify_value_range`` capability in the specified object.


Request Headers
---------------

The HTTP request headers for updating a CDMI data object using HTTP are shown in :numref:`tbl_http_data_object_updaterequest_headers`. 

.. _tbl_http_data_object_updaterequest_headers:

.. list-table:: Request Headers - Update a CDMI Data Object using HTTP
    :header-rows: 1
    :widths: 20 10 55 15
    :align: center 

    * - Header
      - Type
      - Description
      - Requirement
    * - Content-Type
      - Header String
      - The content type of the data to be stored as a data object. The value specified here shall be used in the mimetype field of the CDMI data object.
      - Mandatory
    * - Content-Range
      - Header String
      - A valid ranges-specifier (see :rfc:`2616` Section 14.35.1)
      - Optional
    * - X-CDMI-Partial
      - Header String
      - "true". Indicates that the object is in the process of being updated and has not yet been fully updated. When set, the completionStatus field shall be set to "Processing".
        
        If the completionStatus field had previously been set to "Processing" by including this header in a create or update, the next update without this field shall change the completionStatus field back to "Complete". X-CDMI-Partial works across CDMI and non-CDMI operations.
      - Optional


Request Message Body
--------------------

The request message body contains the data to be stored in the value of the data object.


Response Header
---------------

The HTTP response header for updating a data object using HTTP is shown in :numref:`tbl_http_data_object_updateresponse_header`. 

.. _tbl_http_data_object_updateresponse_header:

.. list-table:: Response Header - Update a CDMI Data Object using HTTP
    :header-rows: 1
    :widths: 20 10 55 15
    :align: center 


    * - Header
      - Type
      - Description
      - Requirement
    * - Location
      - Header String
      - The server shall respond with the URI to which the reference redirects if the object is a reference.
      - Conditional

Response Message Body 
---------------------

A response body may be provided as per :rfc:`2616`.


Response Status
---------------

The HTTP status codes that occur when updating a data object using HTTP are described in :numref:`tbl_http_data_object_updateresponse_status`. 

.. _tbl_http_data_object_updateresponse_status:

.. list-table:: HTTP Status Codes - Update a CDMI Data Object using HTTP
    :header-rows: 1
    :widths: 30 70
    :align: center 

    * - HTTP Status
      - Description
    * - ``204 No Content``
      - The data object content was returned in the response.
    * - ``302 Found``
      - The resource is a reference to another resource.
    * - ``400 Bad Request``
      - The request contains invalid parameters or field names.
    * - ``401 Unauthorized``
      - The authentication credentials are missing or invalid.
    * - ``403 Forbidden``
      - The client lacks the proper authorization to perform this request.
    * - ``404 Not Found``
      - The resource was not found at the specified URI.
    * - ``409 Conflict``
      - The operation conflicts with a non-CDMI access protocol lock or may cause a state transition error on the server.


Examples
--------

EXAMPLE 1: PUT to the data object URI to update the value of the data object:

   .. code-block:: http

       PUT /MyContainer/MyDataObject.txt HTTP/1.1
       Host: cloud.example.com
       Content-Type: text/plain
       Content-Length: 37
       
       This is the value of this data object 

   The following shows the response.

   .. code-block:: http
   
       HTTP/1.1 204 No Content


EXAMPLE 2: PUT to the data object URI to update four bytes within the value of the data object:

   .. code-block:: http

       PUT /MyContainer/MyDataObject.txt HTTP/1.1
       Host: cloud.example.com 
       Content-Range: bytes 21-24/37
       Content-Type: text/plain
       Content-Length: 4
       
       that

   The following shows the response.

   .. code-block:: http
   
    HTTP/1.1 204 No Content 
